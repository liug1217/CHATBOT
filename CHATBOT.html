<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=440, user-scalable=no, viewport-fit=cover">
<title>AI Core - å…¨åŠŸèƒ½ç”¨æˆ¶ç‰ˆ</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
:root { --ai-blue: #007AFF; --bg-light: #F2F2F7; --bg-dark: #121212; }
body { margin:0; display:flex; justify-content:center; font-family:-apple-system, sans-serif; background:var(--bg-dark); }
.app-shell { width:440px; height:95vh; background:#FFF; margin-top:2.5vh; display:flex; flex-direction:column; border-radius:24px; overflow:hidden; }
.header { padding:15px; text-align:center; font-weight:bold; border-bottom:1px solid #ddd; }
.chat-box { flex:1; padding:15px; overflow-y:auto; display:flex; flex-direction:column; gap:10px; background:var(--bg-light); }
.msg { max-width:85%; padding:12px 18px; border-radius:20px; font-size:15px; line-height:1.5; word-wrap:break-word; }
.user { background:var(--ai-blue); color:white; align-self:flex-end; border-bottom-right-radius:4px; }
.ai { background:white; align-self:flex-start; border-bottom-left-radius:4px; box-shadow:0 2px 5px rgba(0,0,0,0.05); }
.thinking { font-style:italic; color:#666; font-size:13px; margin-bottom:5px; }
.input-area { padding:15px; background:white; display:flex; gap:10px; border-top:1px solid #ddd; }
input { flex:1; border:none; background:#eee; padding:12px 18px; border-radius:25px; outline:none; font-size:15px; }
.send-btn { color:var(--ai-blue); cursor:pointer; display:flex; align-items:center; }
</style>
</head>
<body>

<div class="app-shell">
    <div class="header">AI Core - å…¨åŠŸèƒ½ç‰ˆ</div>
    <div class="chat-box" id="chat-box">
        <div class="msg ai">ä½ å¥½ï¼æˆ‘æ˜¯ AI Coreï¼Œå…¨åŠŸèƒ½æ¨¡å¼å·²å•Ÿå‹•ã€‚âœ¨ä½ å¯ä»¥èŠå¤©ã€ç®—æ•¸å­¸æˆ–ç©æ•¸å­—ç‚¸å½ˆéŠæˆ²ã€‚</div>
    </div>
    <div class="input-area">
        <input type="text" id="user-input" placeholder="è¼¸å…¥è¨Šæ¯..." onkeypress="if(event.key==='Enter') processInput()">
        <div class="send-btn" onclick="processInput()">
            <i class="material-icons" style="font-size:30px;">arrow_circle_up</i>
        </div>
    </div>
</div>

<script>
// ===== å›è¦†æ±  =====
const GREET_POOL = ["å—¨ï¼å¾ˆé«˜èˆˆè¦‹åˆ°ä½ ã€‚ğŸ˜Š","ä½ å¥½å‘€ï¼æº–å‚™é–‹å§‹èŠå¤©äº†å—ï¼Ÿ","å“ˆå›‰ï¼æˆ‘å·²å°±ç·’ã€‚âœ¨","æ‚¨å¥½ï¼ŒAI Core éš¨æ™‚å¾…å‘½ã€‚"];
const TIME_POOL = ["æ—©å®‰ï¼å¸Œæœ›ä»Šå¤©ä¸€åˆ‡é †åˆ©â˜€ï¸","åˆå®‰ï¼ä¾†é»ä¼‘æ¯å§â˜•","æ™šå®‰ï¼Œé¡˜ä½ æœ‰å€‹å¥½å¤¢ğŸŒ™"];
const MEMORY_POOL = ["æˆ‘å€‘ä¹‹å‰èŠåˆ°ã€Œ{0}ã€ï¼Œè¦ç¹¼çºŒå—ï¼Ÿ","ä½ ä¹‹å‰æéã€Œ{0}ã€ï¼Œæƒ³å†æ·±å…¥ä¸€ä¸‹å—ï¼Ÿ"];
const PRO_POOL = ["æˆ‘æ˜¯ AI Coreï¼Œå°ˆæ¥­æ¨¡å¼å·²å•Ÿå‹•ã€‚","é—œæ–¼å°ˆæ¥­é ˜åŸŸï¼Œæˆ‘å¯ä»¥å”åŠ©åˆ†æã€‚"];
let chatHistory = JSON.parse(localStorage.getItem('chatHistory') || '[]');

// ===== æ•¸å­—ç‚¸å½ˆéŠæˆ²è®Šæ•¸ =====
let bombGameActive = false;
let bombNumber = 0;
let bombTries = 0;

// ===== åŸºæœ¬åŠŸèƒ½ =====
function addMsg(text, cls){
    const box = document.getElementById('chat-box');
    const d = document.createElement('div');
    d.className = `msg ${cls}`;
    d.innerText = text;
    box.appendChild(d);
    box.scrollTop = box.scrollHeight;
}

function processInput(){
    const input = document.getElementById('user-input');
    const text = input.value.trim();
    if(!text) return;
    addMsg(text,'user');
    input.value = '';

    chatHistory.push(text);
    if(chatHistory.length>10) chatHistory.shift();
    localStorage.setItem('chatHistory', JSON.stringify(chatHistory));

    const box = document.getElementById('chat-box');
    const thinking = document.createElement('div');
    thinking.className='thinking';
    thinking.innerText='AI æ­£åœ¨æ€è€ƒ...';
    box.appendChild(thinking);
    box.scrollTop = box.scrollHeight;

    setTimeout(()=>{
        box.removeChild(thinking);
        let reply = generateReply(text);
        addMsg(reply,'ai');
    },600);
}

function generateReply(text){
    const lower = text.toLowerCase();

    // ===== æ•¸å­—ç‚¸å½ˆéŠæˆ²æŒ‡ä»¤ =====
    if(/é–‹å§‹ç‚¸å½ˆéŠæˆ²/.test(text)){
        bombGameActive = true;
        bombNumber = Math.floor(Math.random()*100)+1;
        bombTries = 0;
        return `ğŸ¯ æ•¸å­—ç‚¸å½ˆéŠæˆ²é–‹å§‹ï¼æˆ‘å·²è¨­ç½®ä¸€å€‹ 1~100 çš„ç‚¸å½ˆæ•¸å­—ã€‚è«‹çŒœä¸€å€‹æ•¸å­—ã€‚`;
    }
    if(bombGameActive){
        const guess = parseInt(text);
        if(!isNaN(guess)){
            bombTries++;
            if(guess === bombNumber){
                bombGameActive = false;
                return `ğŸ’¥ BOOMï¼ä½ è¸©åˆ°ç‚¸å½ˆï¼ç¸½å…±çŒœäº† ${bombTries} æ¬¡ã€‚éŠæˆ²çµæŸã€‚`;
            }else if(guess < bombNumber){
                return `âœ… å®‰å…¨ï¼ä½ çš„æ•¸å­— ${guess} å¤ªå°äº†ï¼Œå†çŒœä¸€æ¬¡ã€‚`;
            }else{
                return `âœ… å®‰å…¨ï¼ä½ çš„æ•¸å­— ${guess} å¤ªå¤§äº†ï¼Œå†çŒœä¸€æ¬¡ã€‚`;
            }
        }
    }

    // ===== æ•¸å­¸é‹ç®— =====
    if(/[0-9\+\-\*\/\=]/.test(text)){
        try{
            let res = eval(text.replace('=',''));
            return `è¨ˆç®—çµæœæ˜¯ï¼š${res}`;
        }catch{
            return "æˆ‘çœ‹ä¸æ‡‚é€™å€‹ç®—å¼ï¼Œä½†æˆ‘å·²è¨˜ä½å®ƒã€‚";
        }
    }

    // ===== å•å€™ / å“ˆå›‰ =====
    if(/å“ˆ|ä½ å¥½|å—¨/.test(text)){
        return GREET_POOL[Math.floor(Math.random()*GREET_POOL.length)];
    }

    // ===== æ™‚é–“å•å€™ =====
    const hour = new Date().getHours();
    if(/æ—©|åˆ|æ™š/.test(text) || hour<10){
        return TIME_POOL[Math.floor(Math.random()*TIME_POOL.length)];
    }

    // ===== ä¸Šä¸‹æ–‡è¨˜æ†¶å›æº¯ =====
    if(chatHistory.length>2 && Math.random()>0.7){
        const old = chatHistory[chatHistory.length-2];
        return MEMORY_POOL[Math.floor(Math.random()*MEMORY_POOL.length)].replace('{0}',old);
    }

    // ===== å°ˆæ¥­æ¨¡å¼ =====
    if(/å°ˆæ¥­|åˆ†æ/.test(text)){
        return PRO_POOL[Math.floor(Math.random()*PRO_POOL.length)];
    }

    // ===== é è¨­å›è¦† =====
    return "æˆ‘å·²æ”¶åˆ°ä½ çš„è¨Šæ¯ï¼Œä¸¦å°‡å…¶è¨˜éŒ„ã€‚";
}

// ===== åˆå§‹åŒ–æ¢å¾©èŠå¤©æ­·å² =====
chatHistory.forEach(m=>addMsg(m,'user'));
</script>

</body>
</html>
