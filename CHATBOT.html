<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=440, user-scalable=no, viewport-fit=cover">
    <title>AI Core - è¨˜æ†¶é€²åŒ–ç‰ˆ</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root { --ai-blue: #007AFF; --glass: rgba(255, 255, 255, 0.8); }
        body { margin: 0; background: #121212; display: flex; justify-content: center; font-family: -apple-system, sans-serif; }
        .app-shell { width: 440px; height: 920px; background: #F2F2F7; display: flex; flex-direction: column; position: relative; overflow: hidden; }
        
        /* è¨˜æ†¶ç‹€æ…‹æŒ‡ç¤ºå™¨ */
        .memory-bar { background: #333; color: #aaa; padding: 5px 15px; font-size: 10px; display: flex; gap: 10px; }
        
        .header { padding: 15px; background: white; text-align: center; font-weight: bold; border-bottom: 1px solid #ddd; }
        .chat-area { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        
        /* æ°£æ³¡æ¨£å¼èˆ‡å‹•ç•« */
        .msg { max-width: 80%; padding: 12px 16px; border-radius: 20px; font-size: 15px; line-height: 1.5; position: relative; word-wrap: break-word; }
        .ai { background: white; align-self: flex-start; border-bottom-left-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .user { background: var(--ai-blue); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        
        @keyframes typing { from { opacity: 0.3; } to { opacity: 1; } }
        .typing-dot { animation: typing 1s infinite alternate; }

        .input-box { padding: 15px; background: white; display: flex; align-items: center; gap: 10px; border-top: 1px solid #ddd; }
        input { flex: 1; border: none; background: #eee; padding: 10px 18px; border-radius: 20px; outline: none; }
        .send-btn { color: var(--ai-blue); cursor: pointer; }
    </style>
</head>
<body>

<div class="app-shell">
    <div class="memory-bar" id="mem-status">ğŸ§  è¨˜æ†¶å±¤ï¼šç©ºç™½ (Ready)</div>
    <div class="header">AI CORE 2.0</div>
    <div class="chat-area" id="chat-box">
        <div class="msg ai">ä½ å¥½ï¼æˆ‘å·²åŠ è¼‰ä¸Šä¸‹æ–‡è¨˜æ†¶æ¨¡çµ„ã€‚è©¦è‘—è·Ÿæˆ‘èŠå¤©ï¼Œæˆ‘æœƒè¨˜ä½ä½ èªªéçš„è©±ã€‚âœ¨</div>
    </div>
    <div class="input-box">
        <input type="text" id="user-in" placeholder="è¼¸å…¥è¨Šæ¯..." onkeypress="if(event.key==='Enter') processInput()">
        <i class="material-icons send-btn" onclick="processInput()">send</i>
    </div>
</div>

<script>
    // ä½ çš„å°ˆå±¬ Token å­—å…¸
    const VOCAB = { "å“ˆ": 36452, "å›‰": "1746,235", "ä½ ": 12942, "å¥½": 8021, "æˆ‘": 7573, "æ˜¯": 3741, "å°ˆ": 1174820, "æ¥­": 22174 };

    // æ“´å±•å‹•æ…‹å›è¦†æ± 
    const RESPONSE_POOLS = {
        GREETING: ["å“ˆå›‰ï¼ğŸ˜Š", "ä½ å¥½å‘€ï¼å¾ˆé«˜èˆˆè¦‹åˆ°ä½ ã€‚", "å—¨ï¼æº–å‚™å¥½é–‹å§‹å·¥ä½œäº†å—ï¼Ÿ", "æ‚¨å¥½ï¼ŒAI æ ¸å¿ƒéš¨æ™‚å¾…å‘½ã€‚"],
        TIME: ["æ—©å®‰ï¼å¸Œæœ›ä½ æœ‰å€‹å……æ»¿æ´»åŠ›çš„ä¸€å¤©ã€‚â˜•", "åˆå®‰ï¼éœ€è¦ä¼‘æ¯ä¸€ä¸‹å—ï¼Ÿ", "æ™šå®‰ï¼Œé¡˜ä½ æœ‰å€‹å¥½å¤¢ã€‚ğŸŒ™"],
        EMO: ["è½èµ·ä¾†ä½ ç¾åœ¨å¿ƒæƒ…ä¸éŒ¯å‘¢ï¼ğŸŒŸ", "åˆ¥æ“”å¿ƒï¼Œæˆ‘æœƒä¸€ç›´é™ªè‘—ä½ ã€‚ğŸ’ª", "å“ˆå“ˆï¼Œé€™å¤ªæœ‰è¶£äº†ï¼ğŸ˜‚"],
        PRO: ["é—œæ–¼å°ˆæ¥­é ˜åŸŸï¼Œæˆ‘èƒ½ç‚ºæ‚¨æä¾›æ·±åº¦çš„ Token åˆ†æã€‚", "æˆ‘æ˜¯ AI å°ˆé–€æ§‹å»ºçš„åŠ©æ‰‹ï¼Œç©©å®šæ€§æ˜¯æˆ‘çš„å¼·é …ã€‚"],
        MEMORY_RECALL: ["å‰›æ‰æˆ‘å€‘èŠåˆ°ã€Œ{0}ã€ï¼Œè¦ç¹¼çºŒæ·±å…¥å—ï¼Ÿ", "ä½ ä¹‹å‰æåˆ°äº†ã€Œ{0}ã€ï¼Œé€™è®“æˆ‘æƒ³åˆ°..."]
    };

    // ä¸Šä¸‹æ–‡è¨˜æ†¶å †æ£§
    let chatHistory = [];

    function processInput() {
        const input = document.getElementById('user-in');
        const text = input.value.trim();
        if (!text) return;

        addMsg(text, 'user');
        input.value = '';

        // 1. Token åˆ†æ
        let tokens = [];
        for (let char of text) tokens.push(VOCAB[char] || 0);

        // 2. è¨˜æ†¶æ›´æ–°ï¼šå°‡ä½¿ç”¨è€…è¼¸å…¥æ¨å…¥æ­·å²
        chatHistory.push(text);
        if (chatHistory.length > 5) chatHistory.shift();
        document.getElementById('mem-status').innerText = `ğŸ§  è¨˜æ†¶å±¤ï¼šå·²å„²å­˜ ${chatHistory.length} æ¢æ­·å²`;

        // 3. ç”Ÿæˆé‚è¼¯ (çµåˆä¸Šä¸‹æ–‡)
        generateDynamicResponse(text, tokens);
    }

    function generateDynamicResponse(text, tokens) {
        let reply = "";
        const now = new Date().getHours();

        // éš¨æ©Ÿ Emoji æ³¨å…¥
        const emojis = ["âœ¨", "ğŸš€", "ğŸ¤–", "ğŸ’¡"];
        const randEmoji = emojis[Math.floor(Math.random() * emojis.length)];

        // A. åˆ¤æ–·æ˜¯å¦ç‚ºæ™‚é–“å•å€™
        if (text.includes("æ—©") || (now < 10 && tokens.includes(8021))) {
            reply = RESPONSE_POOLS.TIME[0];
        } 
        // B. åˆ¤æ–·æ˜¯å¦è§¸ç™¼è¨˜æ†¶å›æº¯ (å¦‚æœæ­·å²ä¸­æœ‰æåˆ°éæŸå€‹é—œéµè©)
        else if (chatHistory.length > 2 && Math.random() > 0.7) {
            const oldTopic = chatHistory[chatHistory.length - 3];
            reply = RESPONSE_POOLS.MEMORY_RECALL[0].replace("{0}", oldTopic);
        }
        // C. åŸºæœ¬å•å€™ (éš¨æ©Ÿæ± )
        else if (tokens.includes(36452) || tokens.includes(8021)) {
            reply = RESPONSE_POOLS.GREETING[Math.floor(Math.random() * RESPONSE_POOLS.GREETING.length)];
        }
        // D. å°ˆæ¥­/èº«ä»½åˆ¤æ–·
        else if (tokens.includes(1174820)) {
            reply = RESPONSE_POOLS.PRO[Math.floor(Math.random() * RESPONSE_POOLS.PRO.length)];
        }
        else {
            reply = `æˆ‘æ­£åœ¨å­¸ç¿’é€™æ®µå…§å®¹... å·²è¨˜éŒ„ Token 0 [${text.substring(0,3)}...] ${randEmoji}`;
        }

        // æ¨¡æ“¬æ‰“å­—æ•ˆæœ
        setTimeout(() => addMsg(reply, 'ai'), 600);
    }

    function addMsg(txt, cl) {
        const box = document.getElementById('chat-box');
        const d = document.createElement('div');
        d.className = `msg ${cl}`;
        d.innerText = txt;
        box.appendChild(d);
        box.scrollTop = box.scrollHeight;
    }
</script>

</body>
</html>
